import openpyxl
from openpyxl.worksheet.worksheet import Worksheet

# 定义快团团订单信息 Excel 文件
ktt_orderfile_name = ('快团团订单.xlsx')
workbook = openpyxl.load_workbook(ktt_orderfile_name)

'''
source_sheet 为输入数据，源为快团团导出全量订单信息“商品列表“ sheet
order_sheet 为输出数据，根据输入数据进行清洗后结果，创建”订单信息” sheet
'''
source_sheet = workbook['商品列表']
order_sheet = workbook.create_sheet('订单信息')

'''
数据提取清洗过程
将源数据 sheet 的值调整后赋给新 sheet
'''
r = source_sheet.max_row + 1
print('共计' + str(r-2) + '条数据\n')
for r in range(1,r):
    order_sheet.cell(row=r, column=1).value = source_sheet.cell(row=r, column=1).value
    order_sheet.cell(row=r, column=2).value = source_sheet.cell(row=r, column=24).value
    order_sheet.cell(row=r, column=3).value = str(source_sheet.cell(row=r, column=6).value)
    order_sheet.cell(row=r, column=4).value = source_sheet.cell(row=r, column=30).value
    order_sheet.cell(row=r, column=5).value = source_sheet.cell(row=r, column=31).value
    order_sheet.cell(row=r, column=6).value = source_sheet.cell(row=r, column=35).value
    order_sheet.cell(row=r, column=7).value = source_sheet.cell(row=r, column=9).value
    order_sheet.cell(row=r, column=8).value = source_sheet.cell(row=r, column=8).value
    order_sheet.cell(row=r, column=9).value = source_sheet.cell(row=r, column=36).value
    order_sheet.cell(row=r, column=10).value = source_sheet.cell(row=r, column=16).value
    order_sheet.cell(row=r, column=11).value = source_sheet.cell(row=r, column=13).value
    print('正在写入第' + str(r) + '行数据')
'''
成单时间分列，取日期，剔除具体时间
'''
for i in range(2,r+1):
    order_sheet.cell(row=i, column=3).value = order_sheet.cell(row=i, column=3).value.split(' ')[0]
print('数据写入完成！\n')
workbook.save(ktt_orderfile_name)
input('按任意键结束……')
